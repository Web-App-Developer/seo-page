$( document ).ready( function () {
    var max_length_title = 600; var max_length_url = 600; var max_length_meta = 1840; var char_cost = []; char_cost[' '] = 5.02; char_cost['-'] = 5.98; char_cost['–'] = 10; char_cost['/'] = 5; char_cost['.'] = 5; char_cost[','] = 5; char_cost[':'] = 5; char_cost['?'] = 10; char_cost['!'] = 5; char_cost['|'] = 4.67; char_cost['&'] = 12; char_cost['('] = 5.98; char_cost[')'] = 5.98; char_cost["'"] = 3.42; char_cost['®'] = 13.25; char_cost['»'] = 8.89; char_cost['€'] = 10; char_cost['$'] = 10; char_cost['£'] = 10; char_cost['#'] = 10; char_cost['0'] = 10; char_cost['1'] = 10; char_cost['2'] = 10; char_cost['3'] = 10; char_cost['4'] = 10; char_cost['5'] = 10; char_cost['6'] = 10; char_cost['7'] = 10; char_cost['8'] = 10; char_cost['9'] = 10; char_cost.a = 10; char_cost.b = 10; char_cost.c = 9; char_cost.d = 10; char_cost.e = 10; char_cost.f = 5; char_cost.g = 10; char_cost.h = 10; char_cost.i = 3.98; char_cost.j = 3.98; char_cost.k = 9; char_cost.l = 3.98; char_cost.m = 14.98; char_cost.n = 10; char_cost.o = 10; char_cost.p = 10; char_cost.q = 10; char_cost.r = 5.98; char_cost.s = 9; char_cost.t = 5; char_cost.u = 10; char_cost.v = 9; char_cost.w = 12.98; char_cost.x = 9; char_cost.y = 9; char_cost.z = 10; char_cost.å = 10; char_cost.ä = 10; char_cost.ö = 10; char_cost.A = 12; char_cost.B = 12; char_cost.C = 12.98; char_cost.D = 12.98; char_cost.E = 12; char_cost.F = 10.98; char_cost.G = 14; char_cost.H = 12.98; char_cost.I = 5; char_cost.J = 9; char_cost.K = 12; char_cost.L = 10; char_cost.M = 14.98; char_cost.N = 12.98; char_cost.O = 14; char_cost.P = 12; char_cost.Q = 14; char_cost.R = 12.98; char_cost.S = 12; char_cost.T = 10.98; char_cost.U = 12.98; char_cost.V = 12; char_cost.W = 16.98; char_cost.X = 12; char_cost.Y = 12; char_cost.Z = 10.98; char_cost.Å = 12; char_cost.Ä = 12; char_cost.Ö = 14; var char_cost_url = []; char_cost_url[' '] = 3.88; char_cost_url['.'] = 3.88; char_cost_url[','] = 3.88; char_cost_url['-'] = 4.66; char_cost_url._ = 7.78; char_cost_url['!'] = 3.88; char_cost_url['?'] = 7.78; char_cost_url['/'] = 3.88; char_cost_url['✔'] = 11.20; char_cost_url[':'] = 3.88; char_cost_url['&'] = 9.33; char_cost_url['0'] = 7.78; char_cost_url['1'] = 7.78; char_cost_url['2'] = 7.78; char_cost_url['3'] = 7.78; char_cost_url['4'] = 7.78; char_cost_url['5'] = 7.78; char_cost_url['6'] = 7.78; char_cost_url['7'] = 7.78; char_cost_url['8'] = 7.78; char_cost_url['9'] = 7.78; char_cost_url.a = 7.78; char_cost_url.b = 7.78; char_cost_url.c = 7; char_cost_url.d = 7.78; char_cost_url.e = 7.78; char_cost_url.f = 3.88; char_cost_url.g = 7.78; char_cost_url.h = 7.78; char_cost_url.i = 3.11; char_cost_url.j = 3.11; char_cost_url.k = 7; char_cost_url.l = 3.11; char_cost_url.m = 11.66; char_cost_url.n = 7.78; char_cost_url.o = 7.78; char_cost_url.p = 7.78; char_cost_url.q = 7.78; char_cost_url.r = 4.66; char_cost_url.s = 7; char_cost_url.t = 3.88; char_cost_url.u = 7.78; char_cost_url.v = 7; char_cost_url.w = 10.11; char_cost_url.x = 7; char_cost_url.y = 7; char_cost_url.z = 7; char_cost_url.å = 7.78; char_cost_url.ä = 7.78; char_cost_url.ö = 7.78; char_cost_url.A = 9.33; char_cost_url.B = 9.33; char_cost_url.C = 10.11; char_cost_url.D = 10.11; char_cost_url.E = 9.33; char_cost_url.F = 8.55; char_cost_url.G = 10.88; char_cost_url.H = 10.11; char_cost_url.I = 3.88; char_cost_url.J = 7; char_cost_url.K = 9.33; char_cost_url.L = 7.78; char_cost_url.M = 11.66; char_cost_url.N = 10.11; char_cost_url.O = 10.88; char_cost_url.P = 9.33; char_cost_url.R = 10.11; char_cost_url.S = 10.11; char_cost_url.T = 8.55; char_cost_url.U = 10.11; char_cost_url.V = 9.33; char_cost_url.W = 13.2; char_cost_url.X = 9.33; char_cost_url.Y = 9.33; char_cost_url.Z = 8.55; char_cost_url.Å = 9.33; char_cost_url.Ä = 9.33; char_cost_url.Ö = 10.88; var char_cost_meta = []; char_cost_meta[' '] = 3.61; char_cost_meta['.'] = 3.61; char_cost_meta[','] = 3.61; char_cost_meta['-'] = 4.33; char_cost_meta['!'] = 3.61; char_cost_meta['?'] = 7.22; char_cost_meta['/'] = 3.61; char_cost_meta['✔'] = 10.41; char_cost_meta[':'] = 3.61; char_cost_meta['('] = 4.33; char_cost_meta[')'] = 4.33; char_cost_meta['"'] = 4.61; char_cost_meta['\n'] = 0; char_cost_meta['|'] = 3.38; char_cost_meta['&'] = 8.66; char_cost_meta['#'] = 7.22; char_cost_meta['»'] = 7.22; char_cost_meta['0'] = 7.22; char_cost_meta['1'] = 7.22; char_cost_meta['2'] = 7.22; char_cost_meta['3'] = 7.22; char_cost_meta['4'] = 7.22; char_cost_meta['5'] = 7.22; char_cost_meta['6'] = 7.22; char_cost_meta['7'] = 7.22; char_cost_meta['8'] = 7.22; char_cost_meta['9'] = 7.22; char_cost_meta.a = 7.22; char_cost_meta.b = 7.22; char_cost_meta.c = 6.5; char_cost_meta.d = 7.22; char_cost_meta.e = 7.22; char_cost_meta.f = 3.61; char_cost_meta.g = 7.22; char_cost_meta.h = 7.22; char_cost_meta.i = 2.88; char_cost_meta.j = 2.88; char_cost_meta.k = 6.5; char_cost_meta.l = 2.88; char_cost_meta.m = 10.83; char_cost_meta.n = 7.22; char_cost_meta.o = 7.22; char_cost_meta.p = 7.22; char_cost_meta.q = 7.22; char_cost_meta.r = 4.33; char_cost_meta.s = 6.5; char_cost_meta.t = 3.61; char_cost_meta.u = 7.22; char_cost_meta.v = 6.5; char_cost_meta.w = 9.38; char_cost_meta.x = 6.5; char_cost_meta.y = 6.5; char_cost_meta.z = 6.5; char_cost_meta.å = 7.22; char_cost_meta.ä = 7.22; char_cost_meta.ö = 7.22; char_cost_meta.A = 8.66; char_cost_meta.B = 8.66; char_cost_meta.C = 9.38; char_cost_meta.D = 9.38; char_cost_meta.E = 8.66; char_cost_meta.F = 7.94; char_cost_meta.G = 10.11; char_cost_meta.H = 9.38; char_cost_meta.I = 3.61; char_cost_meta.J = 6.5; char_cost_meta.K = 8.66; char_cost_meta.L = 7.22; char_cost_meta.M = 10.83; char_cost_meta.N = 9.38; char_cost_meta.O = 10.11; char_cost_meta.P = 8.66; char_cost_meta.Q = 10.11; char_cost_meta.R = 9.38; char_cost_meta.S = 8.66; char_cost_meta.T = 7.94; char_cost_meta.U = 9.38; char_cost_meta.V = 8.66; char_cost_meta.W = 12.27; char_cost_meta.X = 8.66; char_cost_meta.Y = 8.66; char_cost_meta.Z = 7.94; char_cost_meta.Å = 8.66; char_cost_meta.Ä = 8.66; char_cost_meta.Ö = 10.11; function is_url( str ) {
        regexp = /^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/; if ( regexp.test( str ) ) { return !0 }
        else { return !1 }
    }
    function arrowNavigation( element, event ) { switch ( event.which ) { case 38: element.parent().parent().prev().find( '.serp_input:first' ).focus(); break; case 40: element.parent().parent().next().find( '.serp_input:first' ).focus(); break } }
    function countPixels( phrase, ccArray, elmName ) {
        no_of_chars = 0; for ( var i = 0, c = ''; c = phrase.charAt( i ); i++ ) {
            if ( typeof ccArray[c] === 'undefined' ) { console.log( 'Unknown character in ' + elmName + ': ' + c + ' (' + c.charCodeAt() + ')' ); $.post( "/process_serpsim", { action: 'write', missing_char: elmName + '\t' + c + '\t' + c.charCodeAt() + '\n' } ) }
            no_of_chars = Math.round( ( no_of_chars + ccArray[c] ) * 1e12 ) / 1e12
        }
        return no_of_chars
    }
    function substringPixels( phrase, limit, ccArray ) {
        pixel_width = 0; for ( var i = 0, c = ''; c = phrase.charAt( i ); i++ ) {
            if ( pixel_width + ccArray[c] > limit ) { return phrase.substring( 0, i ); break }
            else { pixel_width =                                                                                                                       Math.round( ( pixel_width + ccArray[c] ) * 1e12 ) / 1e12 }
        }
        return phrase
    }
    function truncateUrl( url ) {
        exp = url.split( /^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/ ); prefix_string = exp[2] + ':' + exp[3]; prefix = countPixels( prefix_string, char_cost_url, 'url' ); path = exp[5].split( "/" ); last_part = '/' + path[path.length - 1]; if ( last_part == '/' ) { last_part = '/' + path[path.length - 2] + '/' }
        last_part_pixels = countPixels( last_part, char_cost_url, 'url' ); fit_last = !0; offset = 0; if ( $( "#show_cached" ).prop( 'checked' ) ) { offset = 54 }
        remains = max_length_url - prefix - last_part_pixels - 31.04 - offset; suffix = ""; if ( remains < 0 ) { suffix = '/...' + substringPixels( last_part, last_part_pixels + remains, char_cost_url ) + ' ...' }
        else if ( remains < 15.52 ) {
            pre_suffix = ""; if ( substringPixels( exp[5], remains, char_cost_url ) != "" ) { pre_suffix = substringPixels( exp[5], remains, char_cost_url ) }
            else { pre_suffix = "/" }
            suffix = pre_suffix + '...' + substringPixels( last_part, last_part_pixels + remains, char_cost_url ) + ' ...'
        }
        else { suffix = substringPixels( exp[5], remains, char_cost_url ) + '...' + last_part }
        return prefix_string + suffix
    }
    function truncateString( text, length ) {
        if ( text.length >= length ) { return text.substring( 0, length - 3 ) + '...' }
        else { return text }
    }
    function uncheckBoxes() { $( ".show_box" ).each( function () { if ( $( this ).prop( 'checked' ) === !0 ) { $( this ).trigger( 'click' ) } } ) }
    function clearInput() { $( "#ext_url" ).val( '' ).trigger( 'keyup' ); $( "#title_text" ).val( '' ).trigger( 'keyup' ); $( "#url" ).val( '' ).trigger( 'keyup' ); $( "#meta_desc" ).val( '' ).trigger( 'keyup' ); $( "#snippet_id" ).val( '' ); $( ".active_snippet" ).removeClass( 'active_snippet' ); uncheckBoxes() }
    function fillClipboard() { var clipboard_data = ""; $( ".snippet_list" ).each( function ( i ) { clipboard_data += $( this ).attr( "data-serp-title" ) + "\t" + $( this ).attr( "data-serp-url" ) + "\t" + $( this ).attr( "data-serp-meta" ) + "\r\n" } ); $( "#clipboard_data" ).val( clipboard_data ) }
    function loadSnippet( snippet ) { snippet.addClass( 'active_snippet' ); snippet.find( '.saved_title:first' ).addClass( 'active_snippet' ); snippet.find( '.saved_url:first' ).addClass( 'active_snippet' ); snippet.find( '.delete_snippet:first' ).addClass( 'active_snippet' ); snippet.find( '.snippet_number:first' ).addClass( 'active_snippet' ); $( "#title_text" ).val( snippet.attr( 'data-serp-title' ) ).trigger( 'keyup' ); $( "#url" ).val( snippet.attr( 'data-serp-url' ) ).trigger( 'keyup' ); $( "#meta_desc" ).val( snippet.attr( 'data-serp-meta' ) ).trigger( 'keyup' ); $( "#snippet_id" ).val( snippet.attr( 'data-snippet-id' ) ) }
    function calcNumbers() {
        var snippCount = $( ".snippet_list" ).length; $( ".snippet_list" ).each( function ( i ) {
            currNo = parseInt( snippCount ) - parseInt( i ); $( this ).attr( 'data-list-number', currNo ); if ( currNo % 2 === 0 ) { $( this ).addClass( 'evenDiv' ) }
            else { $( this ).removeClass( 'evenDiv' ) }
            $( ".snippet_number", this ).html( currNo + '.' )
        } )
    }
    $( "#share" ).click( function () {
        if ( $( ".snippet_list" ).length == 0 && ( $( "#serp_title" ).text() == '' && $( "#serp_url" ).text() == '' && $( "#serp_meta" ).text() == '' ) ) { var data = { message: 'Nothing to share', timeout: 2000 }; document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ) }
        else {
            if ( $( ".snippet_list" ).length == 0 && ( $( "#serp_title" ).text() != '' && $( "#serp_url" ).text() != '' && $( "#serp_meta" ).text() != '' ) ) { $( "#save_snippet" ).trigger( 'click' ) }
            serpsim_url = window.location.href; $( "#clipboard_data" ).val( serpsim_url ); var data = { message: 'Project-URL copied to clipboard', timeout: 4000 }; var tempInput = document.createElement( "textarea" ); tempInput.style = "position: absolute; left: -1000px; top: -1000px"; tempInput.value = $( "#clipboard_data" ).val(); document.body.appendChild( tempInput ); tempInput.select(); document.execCommand( "copy" ); document.body.removeChild( tempInput ); document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ); gtag( 'event', 'Share', { 'event_category': 'Snippet', 'event_label': serpsim_url } )
        }
    } ); $( "#copy" ).click( function () { clipboard_data = $( "#title_text" ).val() + "\t" + $( "#url" ).val() + "\t" + $( "#meta_desc" ).val() + "\r\n"; $( "#clipboard_data" ).val( clipboard_data ); var data = { message: 'Snippet copied to clipboard.', timeout: 2000 }; var tempInput = document.createElement( "textarea" ); tempInput.style = "position: absolute; left: -1000px; top: -1000px"; tempInput.value = $( "#clipboard_data" ).val(); document.body.appendChild( tempInput ); tempInput.select(); document.execCommand( "copy" ); document.body.removeChild( tempInput ); document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ) } ); $( "#clear" ).click( function () { clearInput() } ); $( document ).on( "click", ".copy", function () { fillClipboard(); var data = { message: $( ".snippet_list" ).length + ' snippets copied to clipboard.', timeout: 2000 }; var tempInput = document.createElement( "textarea" ); tempInput.style = "position: absolute; left: -1000px; top: -1000px"; tempInput.value = $( "#clipboard_data" ).val(); document.body.appendChild( tempInput ); tempInput.select(); document.execCommand( "copy" ); document.body.removeChild( tempInput ); document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ) } ); $( "#ext_url" ).keyup( function ( e ) { arrowNavigation( $( this ), e ); if ( e.keyCode == 13 ) { $( "#fetch_url" ).trigger( 'click' ) } } ); $( "#save_snippet" ).click( function () {
        if ( $( "#serp_title" ).text() != '' && $( "#serp_url" ).text() != '' && $( "#serp_meta" ).text() != '' ) {
            $( "#serp_result" ).addClass( 'fadeOutDown' ); setTimeout( function () {
                $( "#serp_result" ).removeClass( 'fadeOutDown' ); if ( $( "#snippet_id" ).val() == '' || $( ".snippet_list[data-snippet-id='" + $( "#snippet_id" ).val() + "']" ).length === 0 ) { $( '<div class="snippet_list" data-snippet-id="' + Date.now() + Math.random() + '" data-serp-title="' + $( "#title_text" ).val() + '" data-serp-url="' + $( "#url" ).val() + '" data-serp-meta="' + $( "#meta_desc" ).val() + '" data-list-number="' + ( parseInt( $( ".snippet_list" ).length ) + 1 ) + '"><div class="snippet_number">' + ( $( ".snippet_list" ).length + 1 ) + '.</div><div class="snippet_text"><span class="saved_title">' + $( "#serp_title" ).text() + '</span><span class="saved_url">' + truncateString( $( "#serp_url" ).text(), 80 ) + '</span></div><div class="snippet_options"><i class="material-icons delete_snippet">clear</i></div>' ).insertAfter( $( "#snippet_list_header" ) ); if ( $( ".snippet_list" ).length % 2 === 0 ) { $( ".snippet_list:first" ).addClass( 'evenDiv' ) } }
                else { $( ".snippet_list[data-snippet-id='" + $( "#snippet_id" ).val() + "']" ).attr( "data-serp-title", $( "#title_text" ).val() ).attr( "data-serp-url", $( "#url" ).val() ).attr( "data-serp-meta", $( "#meta_desc" ).val() ); $( ".snippet_list[data-snippet-id='" + $( "#snippet_id" ).val() + "']" ).find( ".saved_title:first" ).html( $( "#serp_title" ).text() ); $( ".snippet_list[data-snippet-id='" + $( "#snippet_id" ).val() + "']" ).find( ".saved_url:first" ).html( $( "#serp_url" ).text() ) }
                extra_snippets = []; $( ".snippet_list" ).each( function ( i ) { extra_snippets[i] = [$( this ).attr( "data-list-number" ), $( this ).attr( "data-snippet-id" ), $( this ).attr( "data-serp-title" ), $( this ).attr( "data-serp-url" ), $( this ).attr( "data-serp-meta" )] } ); slug = window.location.pathname.replace( /\//g, '' ); if ( slug ) { $.post( "/process_serpsim", { action: 'update', title: $( "#title_text" ).val(), url: $( "#url" ).val(), meta: $( "#meta_desc" ).val(), extra: extra_snippets, slug: slug } ); gtag( 'event', 'Update', { 'event_category': 'Button click', 'event_label': slug } ) }
                else { $.post( "/process_serpsim", { action: 'save', title: $( "#title_text" ).val(), url: $( "#url" ).val(), meta: $( "#meta_desc" ).val(), extra: extra_snippets } ).done( function ( json ) { history.replaceState( {}, 'Serpsim', "/" + $.parseJSON( json ).slug + "/" ); slug = $.parseJSON( json ).slug; gtag( 'event', 'Save', { 'event_category': 'Button click', 'event_label': slug } ) } ) }
                $( "#list_container" ).show(); var data = { message: 'Snippet saved.', timeout: 2000 }; document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ); clearInput()
            }, 1000 )
        }
        else { var data = { message: 'Missing data, unable to save.', timeout: 2000 }; document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ) }
    } ); $( "#show_rich" ).click( function () { $( "#rich_div" ).toggle() } ); $( "#show_date" ).click( function () {
        if ( $( "#show_date" ).prop( 'checked' ) ) { $( "#meta_desc" ).trigger( 'keyup' ); $( "#serp_meta" ).prepend( '6 Mar. 2018 - ' ) }
        else { $( "#serp_meta" ).html( $( "#serp_meta" ).html().replace( '6 Mar. 2018 - ', '' ) ); $( "#meta_desc" ).trigger( 'keyup' ) }
    } ); $( "#show_cached" ).click( function () {
        if ( $( ".arrow_container" ).css( 'display' ) == 'none' ) { $( ".arrow_container" ).css( 'display', 'inline' ) }
        else { $( ".arrow_container" ).css( 'display', 'none' ) }
        $( "#url" ).trigger( 'keyup' )
    } ); $( document ).on( "click", ".delete_snippet", function () {
        $( this ).closest( '.snippet_list' ).remove(); calcNumbers(); if ( $( ".snippet_list" ).length == 0 ) { $( "#list_container" ).hide() }
        var data = { message: 'Snippet removed.', timeout: 2000 }; slug = window.location.pathname.replace( /\//g, '' ); extra_snippets = []; $( ".snippet_list" ).each( function ( i ) { extra_snippets[i] = [$( this ).attr( "data-list-number" ), $( this ).attr( "data-snippet-id" ), $( this ).attr( "data-serp-title" ), $( this ).attr( "data-serp-url" ), $( this ).attr( "data-serp-meta" )] } ); $.post( "/process_serpsim", { action: 'update', title: $( "#title_text" ).val(), url: $( "#url" ).val(), meta: $( "#meta_desc" ).val(), extra: extra_snippets, slug: slug } ).done( function () { document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ) } ); if ( $( ".snippet_list" ).length == 0 ) { $( "#list_container" ).hide() }
    } ); $( document ).on( "click", ".snippet_text", function () { clearInput(); loadSnippet( $( this ).closest( '.snippet_list' ) ) } ); $( "#fetch_url" ).click( function () { $.getJSON( "/process_serpsim", { action: 'fetch_url', url: $( "#ext_url" ).val() }, function ( json ) { uncheckBoxes(); $( "#title_text" ).val( json.title.replace( /\s+/g, " " ) ).trigger( 'keyup' ); $( "#meta_desc" ).val( json.meta.replace( /\s+/g, " " ) ).trigger( 'keyup' ); $( "#url" ).val( json.url.replace( /\s+/g, " " ) ).trigger( 'keyup' ); $( "#ext_url" ).val( json.url ); $( "#snippet_id" ).val( '' ); $( ".active_snippet" ).removeClass( 'active_snippet' ) } ).done( function () { var data = { message: 'Data from URL downloaded.', timeout: 2000 }; document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ); gtag( 'event', 'Fetch url', { 'event_category': 'Button click', 'event_label': $( "#ext_url" ).val() } ) } ) } ); $( "#serp_title" ).click( function () { window.open( $( "#serp_url" ).text() ) } ); $( "#title_text" ).keyup( function ( e ) {
        arrowNavigation( $( this ), e ); title_pixel_length = countPixels( $( "#title_text" ).val(), char_cost, 'title' ); curr_length = ""; if ( title_pixel_length > max_length_title ) {
            title_chunks = $( "#title_text" ).val().split( " " ); real_result = ""; real_length = 0; for ( var i = 0, len = title_chunks.length; i < len; i++ ) {
                if ( ( real_length + countPixels( title_chunks[i], char_cost, 'title' ) + 20.02 ) < max_length_title ) { real_result += ' ' + title_chunks[i] }
                else if ( title_chunks.length === 1 ) { real_result = substringPixels( title_chunks[0], max_length_title - 20.02, char_cost ) + ' ...' }
                else {
                    var b = 0; while ( !real_result.slice( -1 ).match( /[a-z]/i ) ) {
                        if ( b > 10 ) { break }
                        real_result = real_result.slice( 0, -1 ); b++
                    }
                    real_result += ' ...'; break
                }
                real_length = countPixels( real_result, char_cost, 'title' )
            }
            $( "#serp_title" ).text( real_result ); curr_length = "<strong><span class='alert'>" + Math.floor( title_pixel_length ) + "px</span></strong>"
        }
        else if ( isNaN( title_pixel_length ) ) { curr_length = '?px' }
        else { $( "#serp_title" ).text( $( "#title_text" ).val() ); curr_length = Math.floor( title_pixel_length ) + "px" }
        $( "#title_length" ).html( '(' + curr_length + ' / ' + max_length_title + 'px)' )
    } ); $( "#url" ).keyup( function ( e ) {
        arrowNavigation( $( this ), e ); url_pixel_length = countPixels( $( "#url" ).val(), char_cost_url, 'url' ); curr_length = ""; offset = 0; if ( $( "#show_cached" ).prop( 'checked' ) ) { offset = 54 }
        if ( url_pixel_length > ( max_length_url - offset ) ) { $( "#serp_url" ).html( truncateUrl( $( "#url" ).val() ) ); curr_length = "<strong><span class='alert'>" + Math.floor( url_pixel_length + offset ) + "px</span></strong>" }
        else if ( isNaN( url_pixel_length ) ) { curr_length = '?px' }
        else { $( "#serp_url" ).html( $( "#url" ).val() ); curr_length = Math.floor( url_pixel_length ) + offset + "px" }
        $( "#url_length" ).html( '(' + curr_length + ' / ' + max_length_url + 'px)' )
    } ); $( "#meta_desc" ).keyup( function ( e ) {
        arrowNavigation( $( this ), e ); offset = 0; if ( $( "#show_date" ).prop( 'checked' ) ) { offset = 76.59 }
        meta_pixel_length = countPixels( $( "#meta_desc" ).val(), char_cost_meta, 'meta' ); if ( meta_pixel_length > max_length_meta ) { $( "#serp_meta" ).text( substringPixels( $( "#meta_desc" ).val(), max_length_meta - 10.83 - offset, char_cost_meta ) + ' ...' ); curr_length = "<strong><span class='alert'>" + Math.floor( meta_pixel_length + offset ) + "px</span></strong>" }
        else if ( isNaN( meta_pixel_length ) ) { curr_length = '?px' }
        else { $( "#serp_meta" ).text( $( "#meta_desc" ).val() ); curr_length = Math.floor( meta_pixel_length + offset ) + 'px' }
        $( "#meta_desc_length" ).html( '(' + curr_length + ' / ' + max_length_meta + 'px)' )
    } ); var loaded_slug = 'WliQMe'; if ( loaded_slug ) {
        $.getJSON( "/process_serpsim", { action: 'load', slug: loaded_slug }, function ( json ) {
            $.each( json, function ( i, item ) { $( '<div class="snippet_list" data-snippet-id="' + item.list_id + '" data-serp-title="' + item.title + '" data-serp-url="' + item.url + '" data-serp-meta="' + item.meta + '" data-list-number="' + item.list_order + '"><div class="snippet_number">' + item.list_order + '.</div><div class="snippet_text"><span class="saved_title">' + item.title + '</span><span class="saved_url">' + truncateString( item.url, 80 ) + '</span></div><div class="snippet_options"><i class="material-icons delete_snippet">clear</i></div>' ).insertAfter( $( "#snippet_list_header" ) ); if ( $( ".snippet_list" ).length % 2 === 0 ) { $( ".snippet_list:first" ).addClass( 'evenDiv' ) } } ); if ( $( ".snippet_list" ).length > 0 ) { $( "#list_container" ).show() }
            var data = { message: 'Saved snippets loaded', timeout: 2000 }; document.querySelector( '#demo-toast-example' ).MaterialSnackbar.showSnackbar( data ); loadSnippet( $( ".snippet_list:first" ) )
        } )
    }
} )
